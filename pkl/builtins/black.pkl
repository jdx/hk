import "../Config.pkl"

black = new Config.Step {
    glob = List("**/*.py")
    stage = "<JOB_FILES>"
    check = "black --check {{ files }}"
    check_list_files = """
# Parse black --check output to get files that need formatting
# Output format: "would reformat filename"
files=$(black --check {{ files }} 2>&1 | grep '^would reformat' | sed 's/^would reformat //')
if [ -n "$files" ]; then
  echo "$files"
  exit 1
fi
"""
    fix = "black {{ files }}"
} 
