import "../Config.pkl"

shfmt = new Config.Step {
    batch = true
    // Matches shell files by extension and shebang (including extensionless scripts)
    types = List("shell")
    glob = List("**/*.bats")  // Also include .bats files which may not be detected by shebang
    stage = List("**/*.sh", "**/*.bash", "**/*.mksh", "**/*.bats", "**/*.zsh")
    check_diff = "shfmt -d {{ files }}"
    check_list_files = """
files=$(shfmt -l {{ files }})
if [ -n "$files" ]; then
  echo "$files"
  exit 1
fi
"""
    fix = "shfmt -w {{ files }}"
}
